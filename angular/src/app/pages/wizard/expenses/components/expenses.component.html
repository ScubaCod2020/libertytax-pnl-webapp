<div data-wizard-step="inputs" class="inputs-wrap">
  <!-- Your selections recap -->
  <div class="recap">
    <div class="recap-title">ğŸ·ï¸ Your Selections <span class="muted">(From Step 1 - Read Only)</span></div>
    <div class="recap-grid">
      <div class="pill-row"><span class="label">Region:</span><span class="pill yellow">{{ settings.region === 'CA' ? 'Canada ğŸ‡¨ğŸ‡¦' : 'United States ğŸ‡ºğŸ‡¸' }}</span></div>
      <div class="pill-row"><span class="label">Store Type:</span><span class="pill green">{{ settings.storeType === 'new' ? 'ğŸ¢ New Store' : 'Existing Store' }}</span></div>
      <div class="pill-row"><span class="label">TaxRush:</span><span class="pill gray">{{ settings.taxRush ? 'Yes, we handle TaxRush' : "No, we don't handle TaxRush" }}</span></div>
      <div class="pill-row"><span class="label">Other Income:</span><span class="pill gray">{{ settings.otherIncome ? 'Yes, we have other income' : 'No, only tax preparation' }}</span></div>
    </div>
  </div>

  <div class="card-title">Income &amp; Expense Inputs</div>
  <p class="small intro">Enter your expected income and expense values. All fields have reasonable defaults, but customizing them will give you more accurate P&amp;L projections.</p>

  <!-- Income Drivers (read-only where configured in Step 1) -->
  <div class="expense-section income">
    <div class="section-title">ğŸ’° Income Drivers</div>
    <div class="grid-row"><label>Average Net Fee</label><div class="grid-field inline"><span class="prefix">$</span><input type="number" class="input sm readonly" [ngModel]="avgNetFee$ | async" disabled title="Configured in Step 1" /></div><div class="small note">Configured in Step 1</div></div>
    <div class="grid-row"><label>Tax Prep Returns</label><div class="grid-field inline"><span class="prefix">#</span><input type="number" class="input sm readonly" [ngModel]="taxPrepReturns$ | async" disabled title="Configured in Step 1" /></div><div class="small note">Configured in Step 1</div></div>
    <div class="blue-box">
      <div class="grid-row"><label>TaxRush Returns</label><div class="grid-field inline"><span class="prefix">#</span><input type="number" class="input sm" placeholder="0" /></div><div class="small note">Expected TaxRush returns (Canada only)</div></div>
    </div>
    <div class="grid-row"><label>Customer Discounts</label><div class="grid-field inline"><input type="number" class="input sm readonly" [ngModel]="discountsPct$ | async" disabled title="Configured in Step 1" /><span class="suffix">%</span></div><div class="small note">Configured in Step 1</div></div>
    <div class="yellow-panel">
      <div class="panel-title">ğŸ’° Projected Gross Revenue Breakdown <span class="status">ğŸŸ¡ On track with strategic plan</span></div>
      <div class="panel-grid">
        <div>
          <div class="panel-sub">Tax Prep Revenue:</div>
          <div class="detail">Gross Tax Prep Fees: <strong>$200,000</strong></div>
          <div class="detail">Returns: 1,600 @ $125</div>
          <div class="detail red">Less Discounts (3%): <strong>-$6,000</strong></div>
          <div class="detail green strong">Net Tax Prep Income: <strong>$194,000</strong></div>
        </div>
      </div>
      <div class="panel-total">Total Gross Revenue: <strong>$194,000</strong><span class="delta">(0% vs target)</span></div>
      <div class="panel-note">This is your projected gross revenue before expenses. Your net income (profit) will be this amount minus all expenses below.</div>
    </div>
  </div>

  <!-- Expense Management -->
  <div class="expense-section">
    <div class="section-title with-action">ğŸ’° Expense Management <button type="button" class="btn-reset" (click)="resetExpensesToDefaults()" title="Reset ONLY expense fields back to strategic defaults (keeps your target performance goals intact)">ğŸ’¸ Reset Expenses to Strategic Defaults</button></div>
    <div class="blue-outline">
      <div class="blue-title">ğŸ“Š Performance-Based Targets</div>
      <div class="blue-line">Strategic Total Expenses: <strong>$147,440</strong><span class="delta">(76.0% of gross revenue)</span></div>
      <div class="blue-line">Expected Net Income: <strong>$46,560</strong><span class="delta">(24.0% margin)</span></div>
      <div class="small">Operational best practices for expense management (75-77% optimal range)</div>
    </div>

    <div class="section-sub">ğŸ“Š Expense Categories <span class="small muted">(16 total fields)</span></div>

    <!-- Personnel -->
    <div class="expense-section light">
      <div class="section-title">ğŸ‘¥Personnel <span class="small muted">(2 fields)</span></div>
      <div class="small italic">Staff-related expenses</div>
      <div class="grid-row multi">
        <label title="Staff salaries as % of gross fees (25% recommended for optimal operations)">Salaries</label>
        <div class="grid-field chain">
          <div class="inline">
            <input type="number" class="input xs" 
                   [ngModel]="salariesPct$ | async" 
                   (ngModelChange)="updateSalariesPct($event)"
                   placeholder="25" />
            <span class="suffix">%</span>
          </div>
          <span class="eq">=</span>
          <div class="inline">
            <span class="prefix">$</span>
            <input type="number" class="input xs" 
                   [ngModel]="((grossRevenue$ | async) || 0) * ((salariesPct$ | async) || 0) / 100" 
                   placeholder="0" readonly />
          </div>
        </div>
        <div class="slider">
          <input type="range" min="0" max="50" step="1" 
                 [ngModel]="salariesPct$ | async" 
                 (ngModelChange)="updateSalariesPct($event)" />
        </div>
        <div class="small note">Staff salaries as % of gross fees (25% recommended for optimal operations) <span class="green"> â€¢ Base: ${{ (grossRevenue$ | async) | number:'1.0-0' }} (gross revenue)</span></div>
      </div>
      <div class="grid-row multi">
        <label title="Payroll taxes, benefits as % of salaries (10% recommended for optimal operations)">Employee Deductions</label>
        <div class="grid-field chain">
          <div class="inline"><input type="number" class="input xs" placeholder="10" [value]="10" /><span class="suffix">%</span></div>
          <span class="eq">=</span>
          <div class="inline"><span class="prefix">$</span><input type="number" class="input xs" placeholder="0" [value]="5000" /></div>
        </div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="10" /></div>
        <div class="small note">Payroll taxes, benefits as % of salaries (10% recommended for optimal operations) <span class="green"> â€¢ Base: $50,000 (salary amount)</span></div>
      </div>
    </div>

    <!-- Facility -->
    <div class="expense-section light">
      <div class="section-title">ğŸ¢Facility <span class="small muted">(3 fields)</span></div>
      <div class="small italic">Office and location costs</div>
      <div class="grid-row multi">
        <label title="Office rent as % of gross fees (18% recommended for optimal operations)">Rent</label>
        <div class="grid-field chain">
          <div class="inline"><input type="number" class="input xs" placeholder="18" [value]="18" /><span class="suffix">%</span></div>
          <span class="eq">=</span>
          <div class="inline"><span class="prefix">$</span><input type="number" class="input xs" placeholder="0" [value]="36000" /></div>
        </div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="18" /></div>
        <div class="small note">Office rent as % of gross fees (18% recommended) <span class="green"> â€¢ Base: $200,000 (gross fees)</span></div>
      </div>
      <div class="grid-row multi">
        <label>Telephone</label>
        <div class="grid-field chain">
          <div class="inline"><input type="number" class="input xs" placeholder="0.5" [value]="0.5" /><span class="suffix">%</span></div>
          <span class="eq">=</span>
          <div class="inline"><span class="prefix">$</span><input type="number" class="input xs" placeholder="0" [value]="1000" /></div>
        </div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="0.5" /></div>
        <div class="small note">Phone/internet costs as % of gross fees <span class="green"> â€¢ Base: $200,000</span></div>
      </div>
      <div class="grid-row multi">
        <label>Utilities</label>
        <div class="grid-field chain">
          <div class="inline"><input type="number" class="input xs" placeholder="1.2" [value]="1.2" /><span class="suffix">%</span></div>
          <span class="eq">=</span>
          <div class="inline"><span class="prefix">$</span><input type="number" class="input xs" placeholder="0" [value]="2400" /></div>
        </div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="1.2" /></div>
        <div class="small note">Utilities as % of gross fees <span class="green"> â€¢ Base: $200,000</span></div>
      </div>
    </div>

    <!-- Operations (subset example) -->
    <div class="expense-section light">
      <div class="section-title">âš™ï¸Operations <span class="small muted">(8 fields)</span></div>
      <div class="small italic">Day-to-day operational expenses</div>
      <div class="grid-row multi">
        <label>Local Advertising</label>
        <div class="grid-field chain">
          <div class="inline"><input type="number" class="input xs" placeholder="2" [value]="2" /><span class="suffix">%</span></div>
          <span class="eq">=</span>
          <div class="inline"><span class="prefix">$</span><input type="number" class="input xs" placeholder="0" [value]="4000" /></div>
        </div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="2" /></div>
        <div class="small note">Local marketing as % of gross fees <span class="green"> â€¢ Base: $200,000</span></div>
      </div>
      <div class="grid-row multi">
        <label>Insurance</label>
        <div class="grid-field chain">
          <div class="inline"><input type="number" class="input xs" placeholder="0.6" [value]="0.6" /><span class="suffix">%</span></div>
          <span class="eq">=</span>
          <div class="inline"><span class="prefix">$</span><input type="number" class="input xs" placeholder="0" [value]="1200" /></div>
        </div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="0.6" /></div>
        <div class="small note">Business insurance as % of gross fees <span class="green"> â€¢ Base: $200,000</span></div>
      </div>
      <div class="grid-row multi">
        <label>Postage</label>
        <div class="grid-field chain">
          <div class="inline"><input type="number" class="input xs" placeholder="0.4" [value]="0.4" /><span class="suffix">%</span></div>
          <span class="eq">=</span>
          <div class="inline"><span class="prefix">$</span><input type="number" class="input xs" placeholder="0" [value]="800" /></div>
        </div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="0.4" /></div>
        <div class="small note">Mailing/shipping as % of gross fees <span class="green"> â€¢ Base: $200,000</span></div>
      </div>
    </div>

    <!-- Franchise -->
    <div class="expense-section light">
      <div class="section-title">ğŸªFranchise <span class="small muted">(2 fields)</span></div>
      <div class="small italic">Franchise fees and royalties</div>
      <div class="grid-row multi">
        <label>Tax Prep Royalties</label>
        <div class="grid-field chain"><div class="inline"><input type="number" class="input xs" [value]="14" disabled readonly /><span class="suffix">%</span></div><span class="eq">=</span><div class="inline"><span class="prefix">$</span><input type="number" class="input xs" [value]="27160" disabled readonly /></div></div>
        <div class="small note">ğŸ”’ Locked per franchise agreement <span class="green"> â€¢ Base: $194,000</span></div>
      </div>
      <div class="grid-row multi">
        <label>Advertising Royalties</label>
        <div class="grid-field chain"><div class="inline"><input type="number" class="input xs" [value]="5" disabled readonly /><span class="suffix">%</span></div><span class="eq">=</span><div class="inline"><span class="prefix">$</span><input type="number" class="input xs" [value]="9700" disabled readonly /></div></div>
        <div class="small note">ğŸ”’ Locked per franchise agreement <span class="green"> â€¢ Base: $194,000</span></div>
      </div>
    </div>

    <!-- Misc -->
    <div class="expense-section light">
      <div class="section-title">ğŸ“Miscellaneous <span class="small muted">(1 field)</span></div>
      <div class="small italic">Other and miscellaneous expenses</div>
      <div class="grid-row multi">
        <label>Miscellaneous</label>
        <div class="grid-field chain"><div class="inline"><input type="number" class="input xs" [value]="2.5" /><span class="suffix">%</span></div><span class="eq">=</span><div class="inline"><span class="prefix">$</span><input type="number" class="input xs" [value]="5000" /></div></div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="2.5" /></div>
        <div class="small note">Other misc expenses (0-1% recommended) <span class="green"> â€¢ Base: $200,000</span></div>
      </div>
    </div>

    <div class="orange-panel">
      <div class="panel-title">ğŸ’° Actual Expense Breakdown <span class="status">ğŸŸ¡ Above optimal range - monitor costs</span></div>
      <div class="panel-line">Total Expenses: <strong>$150,932</strong><span class="delta">(77.8% of gross revenue)</span></div>
      <div class="panel-line">Final Net Income: <strong>$43,068</strong> <span class="delta strong">âœ… Within operational best practices</span></div>
      <div class="small">Operational Target: $147,440 (76.0% of revenue) â€¢ $3,492 over optimal range - monitor costs closely</div>
    </div>
  </div>

  <div class="ready-panel"><div class="small strong green">âœ… Ready to proceed - All required fields completed</div></div>

  <div class="footer-actions">
    <button type="button" class="btn gray">â† Back</button>
    <button type="button" class="btn green">Review Data â†’</button>
  </div>
</div>
<p>expenses works!</p>
