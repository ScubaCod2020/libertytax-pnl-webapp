<div data-wizard-step="inputs" class="inputs-wrap">
  <div class="card-title">Income &amp; Expense Inputs</div>
  <p class="small intro">Enter your expected income and expense values. All fields have reasonable defaults, but customizing them will give you more accurate P&amp;L projections.</p>

  <!-- Revenue Summary (Dynamic based on store type) -->
  <div class="expense-section income">
    <div class="yellow-panel" *ngIf="revenueBreakdown$ | async as revenue">
      <div class="panel-title">ğŸ’° {{ revenue.title }} <span class="status">ğŸŸ¡ On track with strategic plan</span></div>
      <div class="panel-grid">
        <div>
          <div class="panel-sub">Tax Prep Revenue:</div>
          <div class="detail">Gross Tax Prep Fees: <strong>{{ revenue.grossFees | currency }}</strong></div>
          <div class="detail">Returns: {{ revenue.returns | number }} @ {{ revenue.avgNetFee | currency }}</div>
          <div class="detail red">Less Discounts ({{ revenue.discountPct }}%): <strong>-{{ revenue.discountAmt | currency }}</strong></div>
          <div class="detail green strong">Net Tax Prep Income: <strong>{{ revenue.netIncome | currency }}</strong></div>
          <div class="detail" *ngIf="revenue.otherIncome > 0">Other Income: <strong>{{ revenue.otherIncome | currency }}</strong></div>
        </div>
      </div>
      <div class="panel-total">Total Gross Revenue: <strong>{{ revenue.totalRevenue | currency }}</strong><span class="delta">({{ revenue.vsTarget }}% vs target)</span></div>
      <div class="panel-note">{{ revenue.description }}</div>
    </div>
  </div>

  <!-- Expense Management -->
  <div class="expense-section">
    <div class="section-title with-action">ğŸ’° Expense Management <button type="button" class="btn-reset" (click)="resetExpensesToDefaults()" title="Reset ONLY expense fields back to strategic defaults (keeps your target performance goals intact)">ğŸ’¸ Reset Expenses to Strategic Defaults</button></div>
    <div class="blue-outline">
      <div class="blue-title">ğŸ“Š Performance-Based Targets</div>
      <div class="blue-line">Strategic Total Expenses: <strong>$147,440</strong><span class="delta">(76.0% of gross revenue)</span></div>
      <div class="blue-line">Expected Net Income: <strong>$46,560</strong><span class="delta">(24.0% margin)</span></div>
      <div class="small">Operational best practices for expense management (75-77% optimal range)</div>
    </div>

    <div class="section-sub">ğŸ“Š Expense Categories <span class="small muted">(16 total fields)</span></div>

    <!-- Personnel -->
    <div class="expense-section light">
      <div class="section-title">ğŸ‘¥Personnel <span class="small muted">(2 fields)</span></div>
      <div class="small italic">Staff-related expenses</div>
      <div class="grid-row multi">
        <label title="Staff salaries as % of gross fees (25% recommended for optimal operations)">Salaries</label>
        <div class="grid-field chain">
          <div class="inline">
            <input type="number" class="input xs" 
                   [ngModel]="salariesPct$ | async" 
                   (ngModelChange)="updateSalariesPct($event)"
                   placeholder="25" />
            <span class="suffix">%</span>
          </div>
          <span class="eq">=</span>
          <div class="inline">
            <span class="prefix">$</span>
            <input type="number" class="input xs" 
                   [ngModel]="((grossRevenue$ | async) || 0) * ((salariesPct$ | async) || 0) / 100" 
                   placeholder="0" readonly />
          </div>
        </div>
        <div class="slider">
          <input type="range" min="0" max="50" step="1" 
                 [ngModel]="salariesPct$ | async" 
                 (ngModelChange)="updateSalariesPct($event)"
                 aria-label="Salaries percentage slider" />
        </div>
        <div class="small note">Staff salaries as % of gross fees (25% recommended for optimal operations) <span class="green"> â€¢ Base: ${{ (grossRevenue$ | async) | number:'1.0-0' }} (gross revenue)</span></div>
      </div>
      <div class="grid-row multi">
        <label title="Payroll taxes, benefits as % of salaries (10% recommended for optimal operations)">Employee Deductions</label>
        <div class="grid-field chain">
          <div class="inline"><input type="number" class="input xs" placeholder="10" [value]="10" aria-label="Employee deductions percentage" /><span class="suffix">%</span></div>
          <span class="eq">=</span>
          <div class="inline"><span class="prefix">$</span><input type="number" class="input xs" appCurrencyInput placeholder="0" [value]="5000" aria-label="Employee deductions dollar amount" /></div>
        </div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="10" aria-label="Employee deductions percentage slider" /></div>
        <div class="small note">Payroll taxes, benefits as % of salaries (10% recommended for optimal operations) <span class="green"> â€¢ Base: $50,000 (salary amount)</span></div>
      </div>
    </div>

    <!-- Facility -->
    <div class="expense-section light">
      <div class="section-title">ğŸ¢Facility <span class="small muted">(3 fields)</span></div>
      <div class="small italic">Office and location costs</div>
      <div class="grid-row multi">
        <label title="Office rent as % of gross fees (18% recommended for optimal operations)">Rent</label>
        <div class="grid-field chain">
          <div class="inline"><input type="number" class="input xs" placeholder="18" [value]="18" aria-label="Rent percentage" /><span class="suffix">%</span></div>
          <span class="eq">=</span>
          <div class="inline"><span class="prefix">$</span><input type="number" class="input xs" appCurrencyInput placeholder="0" [value]="36000" aria-label="Rent dollar amount" /></div>
        </div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="18" aria-label="Rent percentage slider" /></div>
        <div class="small note">Office rent as % of gross fees (18% recommended) <span class="green"> â€¢ Base: $200,000 (gross fees)</span></div>
      </div>
      <div class="grid-row multi">
        <label>Telephone</label>
        <div class="grid-field chain">
          <div class="inline"><input type="number" class="input xs" placeholder="0.5" [value]="0.5" aria-label="Telephone percentage" /><span class="suffix">%</span></div>
          <span class="eq">=</span>
          <div class="inline"><span class="prefix">$</span><input type="number" class="input xs" appCurrencyInput placeholder="0" [value]="1000" aria-label="Telephone dollar amount" /></div>
        </div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="0.5" aria-label="Telephone percentage slider" /></div>
        <div class="small note">Phone/internet costs as % of gross fees <span class="green"> â€¢ Base: $200,000</span></div>
      </div>
      <div class="grid-row multi">
        <label>Utilities</label>
        <div class="grid-field chain">
          <div class="inline"><input type="number" class="input xs" placeholder="1.2" [value]="1.2" aria-label="Utilities percentage" /><span class="suffix">%</span></div>
          <span class="eq">=</span>
          <div class="inline"><span class="prefix">$</span><input type="number" class="input xs" appCurrencyInput placeholder="0" [value]="2400" aria-label="Utilities dollar amount" /></div>
        </div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="1.2" aria-label="Utilities percentage slider" /></div>
        <div class="small note">Utilities as % of gross fees <span class="green"> â€¢ Base: $200,000</span></div>
      </div>
    </div>

    <!-- Operations (subset example) -->
    <div class="expense-section light">
      <div class="section-title">âš™ï¸Operations <span class="small muted">(8 fields)</span></div>
      <div class="small italic">Day-to-day operational expenses</div>
      <div class="grid-row multi">
        <label>Local Advertising</label>
        <div class="grid-field chain">
          <div class="inline"><input type="number" class="input xs" placeholder="2" [value]="2" aria-label="Local advertising percentage" /><span class="suffix">%</span></div>
          <span class="eq">=</span>
          <div class="inline"><span class="prefix">$</span><input type="number" class="input xs" appCurrencyInput placeholder="0" [value]="4000" aria-label="Local advertising dollar amount" /></div>
        </div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="2" aria-label="Local advertising percentage slider" /></div>
        <div class="small note">Local marketing as % of gross fees <span class="green"> â€¢ Base: $200,000</span></div>
      </div>
      <div class="grid-row multi">
        <label>Insurance</label>
        <div class="grid-field chain">
          <div class="inline"><input type="number" class="input xs" placeholder="0.6" [value]="0.6" aria-label="Insurance percentage" /><span class="suffix">%</span></div>
          <span class="eq">=</span>
          <div class="inline"><span class="prefix">$</span><input type="number" class="input xs" appCurrencyInput placeholder="0" [value]="1200" aria-label="Insurance dollar amount" /></div>
        </div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="0.6" aria-label="Insurance percentage slider" /></div>
        <div class="small note">Business insurance as % of gross fees <span class="green"> â€¢ Base: $200,000</span></div>
      </div>
      <div class="grid-row multi">
        <label>Postage</label>
        <div class="grid-field chain">
          <div class="inline"><input type="number" class="input xs" placeholder="0.4" [value]="0.4" aria-label="Postage percentage" /><span class="suffix">%</span></div>
          <span class="eq">=</span>
          <div class="inline"><span class="prefix">$</span><input type="number" class="input xs" appCurrencyInput placeholder="0" [value]="800" aria-label="Postage dollar amount" /></div>
        </div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="0.4" aria-label="Postage percentage slider" /></div>
        <div class="small note">Mailing/shipping as % of gross fees <span class="green"> â€¢ Base: $200,000</span></div>
      </div>
    </div>

    <!-- Franchise -->
    <div class="expense-section light">
      <div class="section-title">ğŸªFranchise <span class="small muted">(2 fields)</span></div>
      <div class="small italic">Franchise fees and royalties</div>
      <div class="grid-row multi">
        <label>Tax Prep Royalties</label>
        <div class="grid-field chain"><div class="inline"><input type="number" class="input xs" [value]="14" disabled readonly aria-label="Tax prep royalties percentage" /><span class="suffix">%</span></div><span class="eq">=</span><div class="inline"><span class="prefix">$</span><input type="number" class="input xs" appCurrencyInput [value]="27160" disabled readonly aria-label="Tax prep royalties dollar amount" /></div></div>
        <div class="small note">ğŸ”’ Locked per franchise agreement <span class="green"> â€¢ Base: $194,000</span></div>
      </div>
      <div class="grid-row multi">
        <label>Advertising Royalties</label>
        <div class="grid-field chain"><div class="inline"><input type="number" class="input xs" [value]="5" disabled readonly aria-label="Advertising royalties percentage" /><span class="suffix">%</span></div><span class="eq">=</span><div class="inline"><span class="prefix">$</span><input type="number" class="input xs" appCurrencyInput [value]="9700" disabled readonly aria-label="Advertising royalties dollar amount" /></div></div>
        <div class="small note">ğŸ”’ Locked per franchise agreement <span class="green"> â€¢ Base: $194,000</span></div>
      </div>
    </div>

    <!-- Misc -->
    <div class="expense-section light">
      <div class="section-title">ğŸ“Miscellaneous <span class="small muted">(1 field)</span></div>
      <div class="small italic">Other and miscellaneous expenses</div>
      <div class="grid-row multi">
        <label>Miscellaneous</label>
        <div class="grid-field chain"><div class="inline"><input type="number" class="input xs" [value]="2.5" aria-label="Miscellaneous expenses percentage" /><span class="suffix">%</span></div><span class="eq">=</span><div class="inline"><span class="prefix">$</span><input type="number" class="input xs" appCurrencyInput [value]="5000" aria-label="Miscellaneous expenses dollar amount" /></div></div>
        <div class="slider"><input type="range" min="0" max="50" step="1" [value]="2.5" aria-label="Miscellaneous expenses percentage slider" /></div>
        <div class="small note">Other misc expenses (0-1% recommended) <span class="green"> â€¢ Base: $200,000</span></div>
      </div>
    </div>

    <div class="orange-panel">
      <div class="panel-title">ğŸ’° Actual Expense Breakdown <span class="status">ğŸŸ¡ Above optimal range - monitor costs</span></div>
      <div class="panel-line">Total Expenses: <strong>$150,932</strong><span class="delta">(77.8% of gross revenue)</span></div>
      <div class="panel-line">Final Net Income: <strong>$43,068</strong> <span class="delta strong">âœ… Within operational best practices</span></div>
      <div class="small">Operational Target: $147,440 (76.0% of revenue) â€¢ $3,492 over optimal range - monitor costs closely</div>
    </div>
  </div>

  <div class="ready-panel"><div class="small strong green">âœ… Ready to proceed - All required fields completed</div></div>

  <div class="footer-actions">
    <button type="button" class="btn gray">â† Back</button>
    <button type="button" class="btn green">Review Data â†’</button>
  </div>
</div>
<p>expenses works!</p>
