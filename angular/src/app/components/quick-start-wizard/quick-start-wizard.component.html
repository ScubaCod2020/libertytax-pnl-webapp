<div class="page-header page-header--wide">
    <div class="qs-intro">
      <div class="qs-title">{{ title }}</div>
      @if (subtitle) {
        <div class="qs-subtitle">{{ subtitle }}</div>
      }
    </div>

    <div class="page-header__controls">
      @if (editable) {
        <!-- Region row -->
        <div class="qs-row">
          <label class="qs-label">Region<span class="req">*</span></label>
          <div class="qs-field">
            <label for="region-select" class="sr-only">Region</label>
            <select id="region-select" title="Select region" aria-label="Region" class="qs-select region" [ngModel]="settings.region" (ngModelChange)="onRegionChange($event)">
              <option value="US">United States</option>
              <option value="CA">Canada</option>
            </select>
          </div>
          <div class="qs-note small">Affects tax calculations and available features</div>
        </div>

        <!-- Store type row -->
        <div class="qs-row">
          <label class="qs-label">Store Type<span class="req">*</span></label>
          <div class="qs-field">
            <label for="store-type-select" class="sr-only">Store Type</label>
            <select id="store-type-select" title="Select your store type" class="qs-select store" [ngModel]="settings.storeType" (ngModelChange)="onStoreTypeChange($event)">
              <option value="">Select store type...</option>
              <option value="new">New Store (First year)</option>
              <option value="existing">Existing Store</option>
            </select>
          </div>
          <div class="qs-note small">New stores use regional stats, existing stores use your historical data</div>
        </div>

        <!-- Tax year (simple inline row) -->
        <div class="qs-row">
          <label class="qs-label">Tax Year</label>
          <div class="qs-field">
            <input type="number" class="qs-input" [ngModel]="settings.taxYear" (ngModelChange)="onTaxYearChange($event)" />
          </div>
        </div>

        <!-- Local Average Rent for Rent Guard -->
        <div class="qs-row">
          <label class="qs-label">Local Average Rent</label>
          <div class="qs-field">
            <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap">
              <div class="currency"><span class="prefix">$</span><input type="number" class="qs-input" [ngModel]="settings.localAvgRent" (ngModelChange)="settingsSvc.update({ localAvgRent: $event })" placeholder="e.g., 1,500" /></div>
              <select class="qs-select" [ngModel]="settings.rentPeriod" (ngModelChange)="settingsSvc.update({ rentPeriod: $event })">
                <option value="monthly">per month</option>
                <option value="yearly">per year</option>
              </select>
            </div>
          </div>
          <div class="qs-note small">Used by Rent Guard to validate expenses vs local market.</div>
        </div>

        <!-- TaxRush -->
        @if ((appCfg.config$ | async)?.showTaxRush) {
        <div class="qs-box">
          <div class="qs-box-title qs-box-title--primary">TaxRush Returns</div>
          <div class="qs-box-desc">Does your office handle TaxRush returns? (Canada only)</div>
          <div class="qs-box-options">
            <label class="qs-radio"><input type="radio" name="taxrush" [checked]="settings.taxRush" (change)="onTaxRushChange(true)" /><span>Yes, we handle TaxRush returns</span></label>
            <label class="qs-radio"><input type="radio" name="taxrush" [checked]="!settings.taxRush" (change)="onTaxRushChange(false)" /><span>No, we don't handle TaxRush</span></label>
          </div>
        </div>
        }

        <!-- Other Income -->
        <div class="qs-box">
          <div class="qs-box-title qs-box-title--muted">Additional Revenue Streams</div>
          <div class="qs-box-desc">Does your office have other income (bookkeeping, notary, etc.)?</div>
          <div class="qs-box-options">
            <label class="qs-radio"><input type="radio" name="otherincome" [checked]="settings.otherIncome" (change)="onOtherIncomeChange(true)" /><span>Yes, we have other income</span></label>
            <label class="qs-radio"><input type="radio" name="otherincome" [checked]="!settings.otherIncome" (change)="onOtherIncomeChange(false)" /><span>No, only tax prep</span></label>
          </div>
        </div>
      } @else {
        <span class="text-sm" style="color:#6b7280">Region: {{ settings.region === 'CA' ? 'Canada' : 'United States' }} • Store: {{ settings.storeType === 'existing' ? 'Existing' : 'New' }} • TaxRush: {{ settings.taxRush ? 'Yes' : 'No' }} • Other income: {{ settings.otherIncome ? 'Yes' : 'No' }}</span>
      }
    </div>
    <hr />
  </div>


