<aside class="debug-panel" [class.open]="showDetails">
  <header class="debug-header">
    <div class="h3 semibold" style="color: var(--liberty-navy)">Debug Panel</div>
    <button class="btn-link" (click)="showDetails = !showDetails">{{ showDetails ? 'Close' : 'Open' }}</button>
  </header>
  <section class="debug-body" *ngIf="showDetails">
    <div class="small text-xs" style="margin-bottom:8px">Milestones (click to toggle):</div>
    <ul style="list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:6px">
      <li *ngFor="let m of milestones$ | async" style="display:flex;align-items:center;gap:8px">
        <span style="width:16px;text-align:center">
          <ng-container [ngSwitch]="m.state">
            <span *ngSwitchCase="'done'">âœ…</span>
            <span *ngSwitchCase="'in_progress'">ðŸŸ¡</span>
            <span *ngSwitchDefault>â­•</span>
          </ng-container>
        </span>
        <button class="btn-link" (click)="cycleState(m.id)">{{ m.label }}</button>
      </li>
    </ul>
    <hr style="border-color: rgba(255,255,255,0.1); margin: 12px 0;" />
    <div class="small text-xs" style="margin-bottom:8px">Progress Log</div>
    <pre style="white-space:pre-wrap; font-size:12px; color:#0f172a; max-height:160px; overflow:auto">{{ logText }}</pre>
    <div style="display:flex; gap:8px; align-items:center; margin-top:8px">
      <button class="btn" (click)="copyMarkdown()">Copy MD to clipboard</button>
      <button class="btn" (click)="downloadMarkdown()">Download MD</button>
      <button class="btn btn--reset" (click)="clearLog()">Clear Log</button>
    </div>

    <hr style="border-color: rgba(255,255,255,0.1); margin: 12px 0;" />
    <div class="small text-xs" style="margin-bottom:8px">Feature Flags</div>
    <div style="display:flex; flex-direction:column; gap:6px">
      <label style="display:flex; align-items:center; gap:8px">
        <input type="checkbox" [checked]="flags.showAnalysisBlock" (change)="setShowAnalysisBlock($event.target.checked)" />
        Analysis Block (Wizard + Dashboard)
      </label>
      <label style="display:flex; align-items:center; gap:8px">
        <input type="checkbox" [checked]="flags.showMonthlyForecastCard" (change)="setShowMonthlyForecastCard($event.target.checked)" />
        Monthly Forecast Card (Roadmap)
      </label>
      <label style="display:flex; align-items:center; gap:8px">
        <input type="checkbox" [checked]="flags.showMultiStoreSummaryCard" (change)="setShowMultiStoreSummaryCard($event.target.checked)" />
        Multi-Store Summary Card (Roadmap)
      </label>
      <label style="display:flex; align-items:center; gap:8px">
        <input type="checkbox" [checked]="flags.showPerformanceCards" (change)="setShowPerformanceCards($event.target.checked)" />
        Performance Cards (Dashboard)
      </label>
      <!-- Future: add toggles for other enhancement flags here -->
    </div>
  </section>
</aside>
